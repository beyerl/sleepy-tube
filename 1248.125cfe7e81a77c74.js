"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1248],{1248:(Ee,R,o)=>{o.r(R),o.d(R,{PlayerPageModule:()=>Re});var f=o(9808),u=o(6926),E=o(4182),_=o(3249),I=o(655);const p=i=>null==i;var t=o(9863);let z=(()=>{class i{constructor(){}set(e,n){localStorage.setItem(e,JSON.stringify(n))}get(e){const n=localStorage.getItem(e);return p(n)?null:JSON.parse(n)}clear(){localStorage.clear()}delete(e){localStorage.removeItem(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var b=o(5529),y=o(591),v=o(1086),T=o(6498),Z=o(6688),F=o(7043),P=o(4850);function L(i,r,e){return e?L(i,r).pipe((0,P.U)(n=>(0,Z.k)(n)?e(...n):e(n))):new T.y(n=>{const s=(...l)=>n.next(1===l.length?l[0]:l);let a;try{a=i(s)}catch(l){return void n.error(l)}if((0,F.m)(r))return()=>r(s,a)})}var c=o(6053),U=o(4843),J=o(6787),Y=o(2986),x=o(1059),G=o(2868),w=o(1177);function C(i){return r=>r.lift(new W(i))}class W{constructor(r){this.notifier=r}call(r,e){const n=new X(r),s=(0,w.ft)(this.notifier,new w.IY(n));return s&&!n.seenValue?(n.add(s),e.subscribe(n)):n}}class X extends w.Ds{constructor(r){super(r),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}var N=o(2536),K=o(7545),$=o(1709),q=o(826),ee=o(448);function M(...i){return r=>{let e;return"function"==typeof i[i.length-1]&&(e=i.pop()),r.lift(new te(i,e))}}class te{constructor(r,e){this.observables=r,this.project=e}call(r,e){return e.subscribe(new ie(r,this.observables,this.project))}}class ie extends q.L{constructor(r,e,n){super(r),this.observables=e,this.project=n,this.toRespond=[];const s=e.length;this.values=new Array(s);for(let a=0;a<s;a++)this.toRespond.push(a);for(let a=0;a<s;a++)this.add((0,ee.D)(this,e[a],void 0,a))}notifyNext(r,e,n){this.values[n]=e;const s=this.toRespond;if(s.length>0){const a=s.indexOf(n);-1!==a&&s.splice(a,1)}}notifyComplete(){}_next(r){if(0===this.toRespond.length){const e=[r,...this.values];this.project?this._tryProject(e):this.destination.next(e)}}_tryProject(r){let e;try{e=this.project.apply(this,r)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}var ne=o(2014),re=o(5778),se=o(5254),oe=o(3489);class ue{constructor(r){this.predicate=r}call(r,e){return e.subscribe(new de(r,this.predicate))}}class de extends oe.L{constructor(r,e){super(r),this.predicate=e,this.skipping=!0,this.index=0}_next(r){const e=this.destination;this.skipping&&this.tryCallPredicate(r),this.skipping||e.next(r)}tryCallPredicate(r){try{const e=this.predicate(r,this.index++);this.skipping=Boolean(e)}catch(e){this.destination.error(e)}}}var he=o(2198);const ce=["youtubeContainer"];let D=(()=>{class i{constructor(e,n){this._ngZone=e,this._youtubeContainer=new b.xQ,this._destroyed=new b.xQ,this._playerChanges=new y.X(void 0),this._videoId=new y.X(void 0),this._height=new y.X(390),this._width=new y.X(640),this._startSeconds=new y.X(void 0),this._endSeconds=new y.X(void 0),this._suggestedQuality=new y.X(void 0),this._playerVars=new y.X(void 0),this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange"),this._isBrowser=(0,f.NF)(n)}get videoId(){return this._videoId.value}set videoId(e){this._videoId.next(e)}get height(){return this._height.value}set height(e){this._height.next(e||390)}get width(){return this._width.value}set width(e){this._width.next(e||640)}set startSeconds(e){this._startSeconds.next(e)}set endSeconds(e){this._endSeconds.next(e)}set suggestedQuality(e){this._suggestedQuality.next(e)}get playerVars(){return this._playerVars.value}set playerVars(e){this._playerVars.next(e)}ngOnInit(){if(!this._isBrowser)return;let e=(0,v.of)(!0);if(!window.YT||!window.YT.Player){const s=new b.xQ;this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback&&this._existingApiReadyCallback(),this._ngZone.run(()=>s.next(!0))},e=s.pipe((0,Y.q)(1),(0,x.O)(!1))}const n=function fe(i,r,e,n,s,a,l){const m=(0,c.aj)([r,a]).pipe(M((0,c.aj)([n,s])),(0,P.U)(([g,A])=>{const[d,h]=g,[S,k]=A;return d?{videoId:d,playerVars:h,width:S,height:k}:void 0}));return(0,c.aj)([i,m,(0,v.of)(l)]).pipe(function Pe(i){return(0,U.z)(function ae(...i){let r=null;return"function"==typeof i[i.length-1]&&(r=i.pop()),1===i.length&&(0,Z.k)(i[0])&&(i=i[0].slice()),e=>e.lift.call((0,se.D)([e,...i]),new c.Ms(r))}(i),function le(i){return r=>r.lift(new ue(i))}(([r,e])=>!e),(0,P.U)(([r])=>r))}(e),(0,ne.R)(me,void 0),(0,re.x)())}(this._youtubeContainer,this._videoId,e,this._width,this._height,this._playerVars,this._ngZone).pipe((0,G.b)(s=>{this._playerChanges.next(s)}),function ge(i){return(0,$.zg)(r=>r?O(r)?(0,v.of)(r):new T.y(e=>{let n=!1,s=!1;const a=l=>{s=!0,n||(l.target.removeEventListener("onReady",a),e.next(l.target))};return r.addEventListener("onReady",a),()=>{n=!0,s||i(r)}}).pipe((0,Y.q)(1),(0,x.O)(void 0)):(0,v.of)(void 0))}(s=>{O(s)||s.destroy()}),C(this._destroyed),function H(i){return i?(0,N.O)(()=>new b.xQ,i):(0,N.O)(new b.xQ)}());n.subscribe(s=>{this._player=s,s&&this._pendingPlayerState&&this._initializePlayer(s,this._pendingPlayerState),this._pendingPlayerState=void 0}),function ye(i,r,e){(0,c.aj)([i,r,e]).subscribe(([n,s,a])=>n&&n.setSize(s,a))}(n,this._width,this._height),function pe(i,r){(0,c.aj)([i,r]).subscribe(([e,n])=>e&&n&&e.setPlaybackQuality(n))}(n,this._suggestedQuality),function Se(i,r,e,n,s,a){const l=(0,c.aj)([e,n]).pipe((0,P.U)(([d,h])=>({startSeconds:d,endSeconds:h}))),m=l.pipe(V(i,d=>!!d&&!function be(i){const r=i.getPlayerState();return r!==YT.PlayerState.UNSTARTED&&r!==YT.PlayerState.CUED}(d))),g=r.pipe(V(i,(d,h)=>!!d&&d.videoId!==h)),A=i.pipe(V((0,c.aj)([r,l]),([d,h],S)=>!(!S||d==S.videoId&&!h.startSeconds&&!h.endSeconds)));(0,J.T)(A,g,m).pipe(M((0,c.aj)([i,r,l,s])),(0,P.U)(([d,h])=>h),C(a)).subscribe(([d,h,S,k])=>{!h||!d||(d.videoId=h,d.cueVideoById(Object.assign({videoId:h,suggestedQuality:k},S)))})}(n,this._videoId,this._startSeconds,this._endSeconds,this._suggestedQuality,this._destroyed),n.connect()}ngAfterViewInit(){this._youtubeContainer.next(this.youtubeContainer.nativeElement)}ngOnDestroy(){this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._videoId.complete(),this._height.complete(),this._width.complete(),this._startSeconds.complete(),this._endSeconds.complete(),this._suggestedQuality.complete(),this._youtubeContainer.complete(),this._playerVars.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(e,n){this._player?this._player.seekTo(e,n):this._getPendingState().seek={seconds:e,allowSeekAhead:n}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(e){this._player?this._player.setVolume(e):this._getPendingState().volume=e}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(e){if(this._player)return this._player.setPlaybackRate(e);this._getPendingState().playbackRate=e}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_initializePlayer(e,n){const{playbackState:s,playbackRate:a,volume:l,muted:m,seek:g}=n;switch(s){case YT.PlayerState.PLAYING:e.playVideo();break;case YT.PlayerState.PAUSED:e.pauseVideo();break;case YT.PlayerState.CUED:e.stopVideo()}null!=a&&e.setPlaybackRate(a),null!=l&&e.setVolume(l),null!=m&&(m?e.mute():e.unMute()),null!=g&&e.seekTo(g.seconds,g.allowSeekAhead)}_getLazyEmitter(e){return this._playerChanges.pipe((0,K.w)(n=>n?L(s=>{n.addEventListener(e,s)},s=>{try{n.removeEventListener&&n.removeEventListener(e,s)}catch(a){}}):(0,v.of)()),n=>new T.y(s=>n.subscribe({next:a=>this._ngZone.run(()=>s.next(a)),error:a=>s.error(a),complete:()=>s.complete()})),C(this._destroyed))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.R0b),t.Y36(t.Lbi))},i.\u0275cmp=t.Xpm({type:i,selectors:[["youtube-player"]],viewQuery:function(e,n){if(1&e&&t.Gf(ce,5),2&e){let s;t.iGM(s=t.CRH())&&(n.youtubeContainer=s.first)}},inputs:{videoId:"videoId",height:"height",width:"width",startSeconds:"startSeconds",endSeconds:"endSeconds",suggestedQuality:"suggestedQuality",playerVars:"playerVars",showBeforeIframeApiLoads:"showBeforeIframeApiLoads"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},decls:2,vars:0,consts:[["youtubeContainer",""]],template:function(e,n){1&e&&t._UZ(0,"div",null,0)},encapsulation:2,changeDetection:0}),i})();function me(i,[r,e,n]){if(i&&e&&i.playerVars!==e.playerVars)i.destroy();else{if(!e)return void(i&&i.destroy());if(i)return i}const s=n.runOutsideAngular(()=>new YT.Player(r,e));return s.videoId=e.videoId,s.playerVars=e.playerVars,s}function O(i){return"getPlayerStatus"in i}function V(i,r){return(0,U.z)(M(i),(0,he.h)(([e,n])=>r(n,e)),(0,P.U)(([e])=>e))}let ve=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({}),i})(),_e=(()=>{class i{transform(e){if(p(e))return"";const n=Math.floor(e/3600),s=Math.floor((e-3600*n)/60),a=e-3600*n-60*s;return`${this.prependLeadingZero(n)}:${this.prependLeadingZero(s)}:${this.prependLeadingZero(a)}`}prependLeadingZero(e){return e>=10?e.toString():"0"+e.toString()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=t.Yjl({name:"hourMinuteSeconds",type:i,pure:!0}),i})(),Ie=(()=>{class i{transform(e){if(p(e))return"";const n=Math.floor(e/60),s=e-60*n;return n+":"+(s>=10?s.toString():"0"+s.toString())}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=t.Yjl({name:"minuteSeconds",type:i,pure:!0}),i})();const Te=["youtubePlayer"];function we(i,r){1&i&&t._UZ(0,"ion-icon",21)}function Ce(i,r){1&i&&t._UZ(0,"ion-icon",22)}function Me(i,r){if(1&i&&(t.TgZ(0,"ion-row")(1,"ion-col"),t._uU(2," Countdown: "),t.qZA(),t.TgZ(3,"ion-col"),t._uU(4),t.ALo(5,"minuteSeconds"),t.qZA()()),2&i){const e=t.oxw();t.xp6(4),t.hij(" ",t.lcZ(5,1,e.timeout)," ")}}let B=!1;const Ve=[{path:"",component:(()=>{class i{constructor(e){this.keyValueStoreService=e,this.playerWidth=window.innerWidth,this.playerHeight=100,this.SKIP_TIME_IN_SECONDS=30,this.SECONDS_PER_MINUTE=60,this.isVideoLoaded=!1,this.currentTime=0,this.isPauseButton=!1,this.hasPlayed=!1,this.isTimerRunning=!1}ngOnInit(){if(!B){const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api",document.body.appendChild(e),B=!0}}ngAfterViewInit(){new ResizeObserver(n=>{for(let s of n)this.playerWidth=s.contentRect.width}).observe(document.getElementById("player-row"))}ngOnDestroy(){this.videoPlayerReadySubscription.unsubscribe()}get RemainingTime(){return p(this.youtubePlayer)?0:Math.round(this.youtubePlayer.getDuration())-this.currentTime}onOpen(e){return(0,I.mG)(this,void 0,void 0,function*(){this.isVideoLoaded=!1,this.hasPlayed=!1;const n=this.keyValueStoreService.get(e);n&&(this.startSeconds=n),this.videoId=e,this.videoPlayerReadySubscription=this.youtubePlayer.ready.subscribe(()=>this.isVideoLoaded=!0)})}onPlayOrPause(){return(0,I.mG)(this,void 0,void 0,function*(){this.isPauseButton?this.onPause():yield this.onPlay(),this.isPauseButton=!this.isPauseButton})}onPlay(){return(0,I.mG)(this,void 0,void 0,function*(){p(this.videoPlayerIntervalId)||clearInterval(this.videoPlayerIntervalId),this.youtubePlayer.playVideo(),this.hasPlayed=!0,this.videoPlayerIntervalId=setInterval(()=>{this.currentTime=Math.round(this.youtubePlayer.getCurrentTime()),this.keyValueStoreService.set(this.videoId,this.currentTime)},1e3)})}onPause(){this.youtubePlayer.pauseVideo(),this.keyValueStoreService.set(this.videoId,Math.round(this.youtubePlayer.getCurrentTime())),p(this.videoPlayerIntervalId)||clearInterval(this.videoPlayerIntervalId)}onSkipForward(){this.youtubePlayer.seekTo(Math.round(Number(this.keyValueStoreService.get(this.videoId)))+this.SKIP_TIME_IN_SECONDS,!0)}onSkipBackward(){this.youtubePlayer.seekTo(Math.round(Number(this.keyValueStoreService.get(this.videoId)))-this.SKIP_TIME_IN_SECONDS,!0)}onTimerStart(e){p(this.timeoutIntervalId)||clearInterval(this.timeoutIntervalId),this.isTimerRunning=!0,this.isPauseButton||(this.onPlay(),this.isPauseButton=!this.isPauseButton),this.timeout=Number(e)*this.SECONDS_PER_MINUTE,this.timeoutIntervalId=setInterval(()=>{this.timeout>0?this.timeout--:(clearInterval(this.timeoutIntervalId),this.youtubePlayer.pauseVideo(),this.isTimerRunning=!1)},1e3)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(z))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-player"]],viewQuery:function(e,n){if(1&e&&t.Gf(Te,5),2&e){let s;t.iGM(s=t.CRH())&&(n.youtubePlayer=s.first)}},decls:52,vars:23,consts:[[3,"translucent"],["type","text","placeholder","Enter Youtube Id","value","0Ddvxf9wM3o"],["videoIdInput",""],["color","primary",3,"disabled","click"],[3,"fullscreen"],[3,"src"],[1,"ion-justify-content-between"],[1,"ion-text-end"],["id","player-row",1,"ion-justify-content-center"],["suggestedQuality","highres",3,"videoId","width","height","startSeconds"],["youtubePlayer",""],["id","player-row",1,"ion-justify-content-between"],["color","primary","expand","block",3,"disabled","click"],["name","chevron-back-outline"],["name","play-outline",4,"ngIf"],["name","pause-outline",4,"ngIf"],["name","chevron-forward-outline"],["type","number","value","10","min","1","max","60"],["timeoutInput",""],[3,"disabled","click"],[4,"ngIf"],["name","play-outline"],["name","pause-outline"]],template:function(e,n){if(1&e){const s=t.EpF();t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),t._uU(3," SleepyTube "),t.qZA()(),t.TgZ(4,"ion-toolbar")(5,"ion-buttons"),t._UZ(6,"ion-input",1,2),t.TgZ(8,"ion-button",3),t.NdJ("click",function(){t.CHM(s);const l=t.MAs(7);return n.onOpen(l.value)}),t._uU(9," Open "),t.qZA()()()(),t.TgZ(10,"ion-content",4)(11,"ion-grid")(12,"ion-row")(13,"ion-col"),t._UZ(14,"ion-img",5),t.qZA()(),t.TgZ(15,"ion-row",6)(16,"ion-col"),t._uU(17),t.ALo(18,"hourMinuteSeconds"),t.qZA(),t.TgZ(19,"ion-col",7),t._uU(20),t.ALo(21,"hourMinuteSeconds"),t.qZA()(),t.TgZ(22,"ion-row",8),t._UZ(23,"youtube-player",9,10),t.qZA(),t.TgZ(25,"ion-row",11)(26,"ion-col")(27,"ion-button",12),t.NdJ("click",function(){return n.onSkipBackward()}),t._UZ(28,"ion-icon",13),t._uU(29),t.qZA()(),t.TgZ(30,"ion-col")(31,"ion-button",12),t.NdJ("click",function(){return n.onPlayOrPause()}),t.YNc(32,we,1,0,"ion-icon",14),t.YNc(33,Ce,1,0,"ion-icon",15),t.qZA()(),t.TgZ(34,"ion-col")(35,"ion-button",12),t.NdJ("click",function(){return n.onSkipForward()}),t._uU(36),t._UZ(37,"ion-icon",16),t.qZA()()(),t.TgZ(38,"ion-row",11)(39,"ion-col")(40,"ion-item"),t._uU(41," Timer "),t.qZA()(),t.TgZ(42,"ion-col"),t._UZ(43,"ion-input",17,18),t.qZA(),t.TgZ(45,"ion-col")(46,"ion-item"),t._uU(47,"min"),t.qZA()(),t.TgZ(48,"ion-col")(49,"ion-button",19),t.NdJ("click",function(){t.CHM(s);const l=t.MAs(44);return n.onTimerStart(l.value)}),t._uU(50,"Start"),t.qZA()()(),t.YNc(51,Me,6,3,"ion-row",20),t.qZA()()}if(2&e){const s=t.MAs(7);t.Q6J("translucent",!0),t.xp6(8),t.Q6J("disabled",s.value===n.videoId),t.xp6(2),t.Q6J("fullscreen",!0),t.xp6(4),t.MGl("src","https://img.youtube.com/vi/",n.videoId,"/hqdefault.jpg"),t.xp6(3),t.hij(" elapsed: ",t.lcZ(18,19,n.currentTime)," "),t.xp6(3),t.hij(" remaining: ",t.lcZ(21,21,n.RemainingTime)," "),t.xp6(3),t.Q6J("videoId",n.videoId)("width",n.playerWidth)("height",n.playerHeight)("startSeconds",n.startSeconds),t.xp6(4),t.Q6J("disabled",!n.isVideoLoaded||!n.hasPlayed),t.xp6(2),t.hij(" ",n.SKIP_TIME_IN_SECONDS,"s "),t.xp6(2),t.Q6J("disabled",!n.isVideoLoaded),t.xp6(1),t.Q6J("ngIf",!n.isPauseButton),t.xp6(1),t.Q6J("ngIf",n.isPauseButton),t.xp6(2),t.Q6J("disabled",!n.isVideoLoaded||!n.hasPlayed),t.xp6(1),t.hij(" ",n.SKIP_TIME_IN_SECONDS,"s "),t.xp6(13),t.Q6J("disabled",!n.isVideoLoaded),t.xp6(2),t.Q6J("ngIf",n.isTimerRunning)}},directives:[u.Gu,u.sr,u.wd,u.Sm,u.pK,u.j9,u.YG,u.W2,u.jY,u.Nd,u.wI,u.Xz,D,u.gu,f.O5,u.Ie,u.as],pipes:[_e,Ie],styles:[""]}),i})()}];let Ae=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[{provide:f.S$,useClass:f.Do}],imports:[[_.Bz.forChild(Ve)],_.Bz]}),i})(),ke=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[f.ez,E.u5,u.Pc,_.Bz]]}),i})(),Re=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[f.ez,E.u5,u.Pc,ke,Ae,ve]]}),i})()}}]);