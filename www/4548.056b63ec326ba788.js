"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4548],{4548:(Ae,M,o)=>{o.r(M),o.d(M,{PlayerPageModule:()=>ke});var S=o(9808),d=o(6926),E=o(4182),_=o(3249),R=o(655);const m=t=>null==t;var i=o(9863);let z=(()=>{class t{constructor(){}set(e,n){localStorage.setItem(e,JSON.stringify(n))}get(e){const n=localStorage.getItem(e);return m(n)?null:JSON.parse(n)}clear(){localStorage.clear()}delete(e){localStorage.removeItem(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var v=o(5529),y=o(591),b=o(1086),I=o(6498),U=o(6688),B=o(7043),g=o(4850);function Y(t,r,e){return e?Y(t,r).pipe((0,g.U)(n=>(0,U.k)(n)?e(...n):e(n))):new I.y(n=>{const a=(...l)=>n.next(1===l.length?l[0]:l);let s;try{s=t(a)}catch(l){return void n.error(l)}if((0,B.m)(r))return()=>r(a,s)})}var c=o(6053),Z=o(4843),J=o(6787),L=o(2986),x=o(1059),W=o(2868),T=o(1177);function w(t){return r=>r.lift(new G(t))}class G{constructor(r){this.notifier=r}call(r,e){const n=new X(r),a=(0,T.ft)(this.notifier,new T.IY(n));return a&&!n.seenValue?(n.add(a),e.subscribe(n)):n}}class X extends T.Ds{constructor(r){super(r),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}var N=o(2536),H=o(7545),$=o(1709),q=o(826),ee=o(448);function C(...t){return r=>{let e;return"function"==typeof t[t.length-1]&&(e=t.pop()),r.lift(new te(t,e))}}class te{constructor(r,e){this.observables=r,this.project=e}call(r,e){return e.subscribe(new ie(r,this.observables,this.project))}}class ie extends q.L{constructor(r,e,n){super(r),this.observables=e,this.project=n,this.toRespond=[];const a=e.length;this.values=new Array(a);for(let s=0;s<a;s++)this.toRespond.push(s);for(let s=0;s<a;s++)this.add((0,ee.D)(this,e[s],void 0,s))}notifyNext(r,e,n){this.values[n]=e;const a=this.toRespond;if(a.length>0){const s=a.indexOf(n);-1!==s&&a.splice(s,1)}}notifyComplete(){}_next(r){if(0===this.toRespond.length){const e=[r,...this.values];this.project?this._tryProject(e):this.destination.next(e)}}_tryProject(r){let e;try{e=this.project.apply(this,r)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}var ne=o(2014),re=o(5778),ae=o(5254),oe=o(3489);class ue{constructor(r){this.predicate=r}call(r,e){return e.subscribe(new de(r,this.predicate))}}class de extends oe.L{constructor(r,e){super(r),this.predicate=e,this.skipping=!0,this.index=0}_next(r){const e=this.destination;this.skipping&&this.tryCallPredicate(r),this.skipping||e.next(r)}tryCallPredicate(r){try{const e=this.predicate(r,this.index++);this.skipping=Boolean(e)}catch(e){this.destination.error(e)}}}var he=o(2198);const ce=["youtubeContainer"];let Q=(()=>{class t{constructor(e,n){this._ngZone=e,this._youtubeContainer=new v.xQ,this._destroyed=new v.xQ,this._playerChanges=new y.X(void 0),this._videoId=new y.X(void 0),this._height=new y.X(390),this._width=new y.X(640),this._startSeconds=new y.X(void 0),this._endSeconds=new y.X(void 0),this._suggestedQuality=new y.X(void 0),this._playerVars=new y.X(void 0),this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange"),this._isBrowser=(0,S.NF)(n)}get videoId(){return this._videoId.value}set videoId(e){this._videoId.next(e)}get height(){return this._height.value}set height(e){this._height.next(e||390)}get width(){return this._width.value}set width(e){this._width.next(e||640)}set startSeconds(e){this._startSeconds.next(e)}set endSeconds(e){this._endSeconds.next(e)}set suggestedQuality(e){this._suggestedQuality.next(e)}get playerVars(){return this._playerVars.value}set playerVars(e){this._playerVars.next(e)}ngOnInit(){if(!this._isBrowser)return;let e=(0,b.of)(!0);if(!window.YT||!window.YT.Player){const a=new v.xQ;this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback&&this._existingApiReadyCallback(),this._ngZone.run(()=>a.next(!0))},e=a.pipe((0,L.q)(1),(0,x.O)(!1))}const n=function fe(t,r,e,n,a,s,l){const f=(0,c.aj)([r,s]).pipe(C((0,c.aj)([n,a])),(0,g.U)(([p,A])=>{const[u,h]=p,[P,V]=A;return u?{videoId:u,playerVars:h,width:P,height:V}:void 0}));return(0,c.aj)([t,f,(0,b.of)(l)]).pipe(function Pe(t){return(0,Z.z)(function se(...t){let r=null;return"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&(0,U.k)(t[0])&&(t=t[0].slice()),e=>e.lift.call((0,ae.D)([e,...t]),new c.Ms(r))}(t),function le(t){return r=>r.lift(new ue(t))}(([r,e])=>!e),(0,g.U)(([r])=>r))}(e),(0,ne.R)(Se,void 0),(0,re.x)())}(this._youtubeContainer,this._videoId,e,this._width,this._height,this._playerVars,this._ngZone).pipe((0,W.b)(a=>{this._playerChanges.next(a)}),function ge(t){return(0,$.zg)(r=>r?O(r)?(0,b.of)(r):new I.y(e=>{let n=!1,a=!1;const s=l=>{a=!0,n||(l.target.removeEventListener("onReady",s),e.next(l.target))};return r.addEventListener("onReady",s),()=>{n=!0,a||t(r)}}).pipe((0,L.q)(1),(0,x.O)(void 0)):(0,b.of)(void 0))}(a=>{O(a)||a.destroy()}),w(this._destroyed),function K(t){return t?(0,N.O)(()=>new v.xQ,t):(0,N.O)(new v.xQ)}());n.subscribe(a=>{this._player=a,a&&this._pendingPlayerState&&this._initializePlayer(a,this._pendingPlayerState),this._pendingPlayerState=void 0}),function ye(t,r,e){(0,c.aj)([t,r,e]).subscribe(([n,a,s])=>n&&n.setSize(a,s))}(n,this._width,this._height),function pe(t,r){(0,c.aj)([t,r]).subscribe(([e,n])=>e&&n&&e.setPlaybackQuality(n))}(n,this._suggestedQuality),function me(t,r,e,n,a,s){const l=(0,c.aj)([e,n]).pipe((0,g.U)(([u,h])=>({startSeconds:u,endSeconds:h}))),f=l.pipe(k(t,u=>!!u&&!function ve(t){const r=t.getPlayerState();return r!==YT.PlayerState.UNSTARTED&&r!==YT.PlayerState.CUED}(u))),p=r.pipe(k(t,(u,h)=>!!u&&u.videoId!==h)),A=t.pipe(k((0,c.aj)([r,l]),([u,h],P)=>!(!P||u==P.videoId&&!h.startSeconds&&!h.endSeconds)));(0,J.T)(A,p,f).pipe(C((0,c.aj)([t,r,l,a])),(0,g.U)(([u,h])=>h),w(s)).subscribe(([u,h,P,V])=>{!h||!u||(u.videoId=h,u.cueVideoById(Object.assign({videoId:h,suggestedQuality:V},P)))})}(n,this._videoId,this._startSeconds,this._endSeconds,this._suggestedQuality,this._destroyed),n.connect()}ngAfterViewInit(){this._youtubeContainer.next(this.youtubeContainer.nativeElement)}ngOnDestroy(){this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._videoId.complete(),this._height.complete(),this._width.complete(),this._startSeconds.complete(),this._endSeconds.complete(),this._suggestedQuality.complete(),this._youtubeContainer.complete(),this._playerVars.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(e,n){this._player?this._player.seekTo(e,n):this._getPendingState().seek={seconds:e,allowSeekAhead:n}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(e){this._player?this._player.setVolume(e):this._getPendingState().volume=e}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(e){if(this._player)return this._player.setPlaybackRate(e);this._getPendingState().playbackRate=e}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_initializePlayer(e,n){const{playbackState:a,playbackRate:s,volume:l,muted:f,seek:p}=n;switch(a){case YT.PlayerState.PLAYING:e.playVideo();break;case YT.PlayerState.PAUSED:e.pauseVideo();break;case YT.PlayerState.CUED:e.stopVideo()}null!=s&&e.setPlaybackRate(s),null!=l&&e.setVolume(l),null!=f&&(f?e.mute():e.unMute()),null!=p&&e.seekTo(p.seconds,p.allowSeekAhead)}_getLazyEmitter(e){return this._playerChanges.pipe((0,H.w)(n=>n?Y(a=>{n.addEventListener(e,a)},a=>{try{n.removeEventListener&&n.removeEventListener(e,a)}catch(s){}}):(0,b.of)()),n=>new I.y(a=>n.subscribe({next:s=>this._ngZone.run(()=>a.next(s)),error:s=>a.error(s),complete:()=>a.complete()})),w(this._destroyed))}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.R0b),i.Y36(i.Lbi))},t.\u0275cmp=i.Xpm({type:t,selectors:[["youtube-player"]],viewQuery:function(e,n){if(1&e&&i.Gf(ce,5),2&e){let a;i.iGM(a=i.CRH())&&(n.youtubeContainer=a.first)}},inputs:{videoId:"videoId",height:"height",width:"width",startSeconds:"startSeconds",endSeconds:"endSeconds",suggestedQuality:"suggestedQuality",playerVars:"playerVars",showBeforeIframeApiLoads:"showBeforeIframeApiLoads"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},decls:2,vars:0,consts:[["youtubeContainer",""]],template:function(e,n){1&e&&i._UZ(0,"div",null,0)},encapsulation:2,changeDetection:0}),t})();function Se(t,[r,e,n]){if(t&&e&&t.playerVars!==e.playerVars)t.destroy();else{if(!e)return void(t&&t.destroy());if(t)return t}const a=n.runOutsideAngular(()=>new YT.Player(r,e));return a.videoId=e.videoId,a.playerVars=e.playerVars,a}function O(t){return"getPlayerStatus"in t}function k(t,r){return(0,Z.z)(C(t),(0,he.h)(([e,n])=>r(n,e)),(0,g.U)(([e])=>e))}let be=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({}),t})(),_e=(()=>{class t{transform(e){if(m(e))return"";const n=Math.floor(e/60),a=e-60*n;return n+":"+(a>=10?a.toString():"0"+a.toString())}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=i.Yjl({name:"minuteSeconds",type:t,pure:!0}),t})();const Ie=["youtubePlayer"];let F=!1;const Te=[{path:"",component:(()=>{class t{constructor(e){this.keyValueStoreService=e,this.playerWidth=window.innerWidth,this.playerHeight=200,this.SKIP_TIME_IN_SECONDS=30,this.SECONDS_PER_MINUTE=60}ngOnInit(){if(!F){const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api",document.body.appendChild(e),F=!0}}ngAfterViewInit(){new ResizeObserver(n=>{for(let a of n)this.playerWidth=a.contentRect.width}).observe(document.getElementById("player-row"))}onOpen(e){return(0,R.mG)(this,void 0,void 0,function*(){const n=this.keyValueStoreService.get(e);n&&(this.startSeconds=n),this.videoId=e})}onPlay(){return(0,R.mG)(this,void 0,void 0,function*(){m(this.videoPlayerIntervalId)||clearInterval(this.videoPlayerIntervalId),this.youtubePlayer.playVideo(),this.videoPlayerIntervalId=setInterval(()=>this.keyValueStoreService.set(this.videoId,Math.round(this.youtubePlayer.getCurrentTime())),5e3)})}onPause(){this.youtubePlayer.pauseVideo(),this.keyValueStoreService.set(this.videoId,Math.round(this.youtubePlayer.getCurrentTime())),m(this.videoPlayerIntervalId)||clearInterval(this.videoPlayerIntervalId)}onSkipForward(){this.youtubePlayer.seekTo(Math.round(this.youtubePlayer.getCurrentTime())+this.SKIP_TIME_IN_SECONDS,!0)}onSkipBackward(){this.youtubePlayer.seekTo(Math.round(this.youtubePlayer.getCurrentTime())-this.SKIP_TIME_IN_SECONDS,!0)}onTimerStart(e){m(this.timeoutIntervalId)||clearInterval(this.timeoutIntervalId),this.youtubePlayer.playVideo(),this.timeout=Number(e)*this.SECONDS_PER_MINUTE,this.timeoutIntervalId=setInterval(()=>{this.timeout>0?this.timeout--:(clearInterval(this.timeoutIntervalId),this.youtubePlayer.pauseVideo())},1e3)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(z))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-player"]],viewQuery:function(e,n){if(1&e&&i.Gf(Ie,5),2&e){let a;i.iGM(a=i.CRH())&&(n.youtubePlayer=a.first)}},decls:51,vars:10,consts:[[3,"translucent"],["type","text","placeholder","Enter Youtube Id","value","0Ddvxf9wM3o"],["videoIdInput",""],["color","primary",3,"click"],[3,"fullscreen"],["id","player-row",1,"ion-justify-content-center"],["suggestedQuality","highres",3,"videoId","width","height","startSeconds"],["youtubePlayer",""],["id","player-row",1,"ion-justify-content-between"],["color","primary","expand","block",3,"click"],["type","number","value","10","min","1","max","60"],["timeoutInput",""],[3,"click"]],template:function(e,n){if(1&e){const a=i.EpF();i.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),i._uU(3," SleepyTube "),i.qZA()(),i.TgZ(4,"ion-toolbar")(5,"ion-buttons"),i._UZ(6,"ion-input",1,2),i.TgZ(8,"ion-button",3),i.NdJ("click",function(){i.CHM(a);const l=i.MAs(7);return n.onOpen(l.value)}),i._uU(9,"Open"),i.qZA()()()(),i.TgZ(10,"ion-content",4)(11,"ion-grid")(12,"ion-row",5),i._UZ(13,"youtube-player",6,7),i.qZA(),i.TgZ(15,"ion-row",8)(16,"ion-col")(17,"ion-button",9),i.NdJ("click",function(){return n.onPlay()}),i._uU(18,"Play"),i.qZA()(),i.TgZ(19,"ion-col")(20,"ion-button",9),i.NdJ("click",function(){return n.onPause()}),i._uU(21,"Pause"),i.qZA()()(),i.TgZ(22,"ion-row",8)(23,"ion-col")(24,"ion-button",9),i.NdJ("click",function(){return n.onSkipForward()}),i._uU(25,"<"),i.qZA()(),i.TgZ(26,"ion-col")(27,"ion-item"),i._uU(28),i.qZA()(),i.TgZ(29,"ion-col")(30,"ion-button",9),i.NdJ("click",function(){return n.onSkipForward()}),i._uU(31,">"),i.qZA()()(),i.TgZ(32,"ion-row",8)(33,"ion-col")(34,"ion-item"),i._uU(35," Timer "),i.qZA()(),i.TgZ(36,"ion-col"),i._UZ(37,"ion-input",10,11),i.qZA(),i.TgZ(39,"ion-col")(40,"ion-item"),i._uU(41,"min"),i.qZA()(),i.TgZ(42,"ion-col")(43,"ion-button",12),i.NdJ("click",function(){i.CHM(a);const l=i.MAs(38);return n.onTimerStart(l.value)}),i._uU(44,"Start"),i.qZA()()(),i.TgZ(45,"ion-row")(46,"ion-col"),i._uU(47," Countdown: "),i.qZA(),i.TgZ(48,"ion-col"),i._uU(49),i.ALo(50,"minuteSeconds"),i.qZA()()()()}2&e&&(i.Q6J("translucent",!0),i.xp6(10),i.Q6J("fullscreen",!0),i.xp6(3),i.Q6J("videoId",n.videoId)("width",n.playerWidth)("height",n.playerHeight)("startSeconds",n.startSeconds),i.xp6(15),i.hij(" ",n.SKIP_TIME_IN_SECONDS," sec "),i.xp6(21),i.hij(" ",i.lcZ(50,8,n.timeout)," "))},directives:[d.Gu,d.sr,d.wd,d.Sm,d.pK,d.j9,d.YG,d.W2,d.jY,d.Nd,Q,d.wI,d.Ie,d.as],pipes:[_e],styles:[""]}),t})()}];let we=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[{provide:S.S$,useClass:S.Do}],imports:[[_.Bz.forChild(Te)],_.Bz]}),t})(),Ce=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[S.ez,E.u5,d.Pc,_.Bz]]}),t})(),ke=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[S.ez,E.u5,d.Pc,Ce,we,be]]}),t})()}}]);